<html>
<head>
    <title>lrn2webgl</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        canvas#glcanvas {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
<canvas id="glcanvas" width="640" height="480"></canvas>

<script id="blinnPhong-fs" type="x-shader/x-fragment">
precision mediump float;

varying vec3 interpretedNormal;
varying vec3 vertexPos;

varying highp vec2 vTextureCoord;

uniform sampler2D uSampler;

uniform int mode;

const vec3 lightPos = vec3(1.0,1.0,1.0);
const vec3 ambientColor = vec3(0.3, 0.3, 0.3);
const vec3 diffuseColor = vec3(0.7, 0.7, 0.7);
const vec3 specColor = vec3(1.0, 1.0, 1.0);

void main() {

  vec3 normal = normalize(interpretedNormal);
  vec3 lightDir = normalize(lightPos - vertexPos);

  float lambertian = max(dot(lightDir,normal), 0.0);
  float specular = 0.0;

  if(lambertian > 0.0) {

    vec3 viewDir = normalize(-vertexPos);

    vec3 halfDir = normalize(lightDir + viewDir);
    float specAngle = max(dot(halfDir, normal), 0.0);
    specular = pow(specAngle, 16.0);
  }

  gl_FragColor = vec4(ambientColor +
                      lambertian * diffuseColor +
                      specular * specColor, 1.0) *
                      texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));

}
</script>
<script id="blinnPhong-vs" type="x-shader/x-vertex">
attribute vec3 inputPosition;
attribute vec3 aVertexPosition;
attribute vec3 aVertexNormal;
attribute vec2 aTextureCoord;

uniform mat4 uPMatrix, uMVMatrix, uNormalMatrix;

varying vec3 interpretedNormal;
varying vec3 vertexPos;
varying highp vec2 vTextureCoord;

void main(){
    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
    vec4 vertexPos4 = uMVMatrix * vec4(aVertexPosition, 1.0);
    vertexPos = vec3(vertexPos4) / vertexPos4.w;
    interpretedNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 0.0));
    vTextureCoord = aTextureCoord;
}

</script>

<script id="simpleTexture-fs" type="x-shader/x-fragment">
varying highp vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void) {
    gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
}
</script>
<script id="simpleTexture-vs" type="x-shader/x-vertex">
attribute vec3 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat4 uMVMatrix;
uniform mat4 uPMatrix;

varying highp vec2 vTextureCoord;

void main(void) {
    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
    vTextureCoord = aTextureCoord;
}
</script>



<script src="js/async.js"></script>

<script src="js/friendly.js"></script>
<script src="js/palette.js"></script>

<script src="js/sylvester.js"></script>
<script src="js/glUtils.js"></script>
<script src="js/maths.js"></script>
<script src="js/model.js"></script>
<script src="js/entity.js"></script>
<script src="js/render.js"></script>
<script src="js/loader.js"></script>

<script src="js/main.js"></script>
</body>

</html>
